<apex:page contentType="application/vnd.ms-excel#RevenuePrioritization.xls" controller="Revenue_PrioritizationController"  cache="true">   
<html>
   
    <body>
        <apex:form > 
            <div style="background-color:#F7F9FB;border:1px solid #EEF0F3;">
                <table style="width:100%">                        
                    <tr>                                
                        <td colspan="3">
                            <font style="color: #969799;    font-size: 20px;  ">REPORT</font><br/>
                            <font style="font-size: 20px;  font-normal: bold;  color: #26385F;">Revenue prioritization.</font>
                            <br/>
                        </td>
                    </tr>
                    <tr>                       

                        <td style="vertical-align:top">                                    
                            <font style="color: #969799;    font-size: 12px;  "> VIEWING AS</font><br/>
                            <font style="font-size: 12px;  font-normal: bold;  color: #26385F;">{!$User.FirstName} {!$User.LastName}</font>
                        </td>
                        <td style="vertical-align:top">                                   
                            <font style="color: #969799;    font-size: 12px;  "> LAST REFRESH</font><br/>
                            <font style="font-size: 12px;  font-normal: bold;  color: #26385F;">
                                <apex:outputText value="{0, date, MMMM d','  yyyy}">
                                    <apex:param value="{!LastLoginDate}" /> 
                                </apex:outputText>
                            </font>
                        </td>
                        <td style="vertical-align:top">                                    
                            <font style="color: #969799;    font-size: 12px;  "> DESCRIPTION</font><br/>
                            <font style="font-size: 12px;  font-normal: bold;  color: #26385F;">Prioritize the opportunities which has the highest Revenue plan Across periods.</font>
                        </td>
                       
                    </tr>
                </table>

            </div>
            <br/>
             <div style="background-color:#F7F9FB;border:1px solid #EEF0F3;padding:10px">
                <table style="width:100%">
                    <tr>

                        <td style="width:20%;text-align:left;vertical-align:top">
                            <font style="color: #969799;    font-size: 14px;  "> PLANNING YEAR</font><br/>
                            <font style="font-size: 14px;  font-normal: bold;  color: #26385F;">{!HTMLENCODE(strFromPlanYear)}</font>
                        </td>
                        <td  style="width:20%;text-align:left;vertical-align:top">
                            <font style="color: #969799;font-size: 14px;  "> PLANNING VERSION</font><br/>
                            <font style="font-size: 14px;  font-normal: bold;  color: #26385F;">{!HTMLENCODE(strFromPlanversion)}</font> 
                        </td>
                        <td style="width:20%;text-align:left;vertical-align:top">
                            <font style="color: #969799;font-size: 14px;  "> QUARTER</font><br/>
                            <font style="font-size: 14px;  font-normal: bold;  color: #26385F;">{!HTMLENCODE(strQuarter)}</font>
                        </td>
                        <td style="width:20%;text-align:left;vertical-align:top">
                            <font style="color: #969799;font-size: 14px;  "> ACCOUNT OWNER</font><br/>
                            <font style="font-size: 14px;  font-normal: bold;  color: #26385F;">{!HTMLENCODE(strAccOwner)}</font>
                        </td>
                        <td style="width:20%;text-align:left;vertical-align:top">
                            <font style="color: #969799;font-size: 14px;  "> BUSINESS UNIT</font><br/>
                            <font style="font-size: 14px;  font-normal: bold;  color: #26385F;">{!HTMLENCODE(dummyOpportunity.BussinessUnit__c)}</font>
                        </td>
                        <td style="width:20%;text-align:left;vertical-align:top">
                            <font style="color: #969799;font-size: 14px;  "> DIVISION</font><br/>
                            <font style="font-size: 14px;  font-normal: bold;  color: #26385F;">{!HTMLENCODE(dummyOpportunity.Division__c)}</font>
                        </td>
                        <td style="width:20%;text-align:left;vertical-align:top">
                            <font style="color: #969799;font-size: 14px;  ">ACCOUNT</font><br/>
                            <font style="font-size: 14px;  font-normal: bold;  color: #26385F;">{!HTMLENCODE(sAccountText)}</font>
                            
                        </td>
                        <td style="width:20%;text-align:left;vertical-align:top">
                            <font style="color: #969799;font-size: 14px;  ">OPPORTUNITY</font><br/>
                            <font style="font-size: 14px;  font-normal: bold;  color: #26385F;">{!HTMLENCODE(sOpportunityText)}</font>
                            
                        </td>
                    </tr>                           
                </table>
            </div>
            <br/>
                                     <div id="containerrecords">

                                        <table class="slds-table slds-table--bordered" id="revpriotab">
                                            <thead>
                                                <tr style="background-color:#A9A9A9">
                                                
                                                    <th scope="col"><span class="slds-truncate">Account</span></th>
                                                    <th scope="col"><span class="slds-truncate">Account Owner</span></th>
                                                    <th scope="col"><span class="slds-truncate">Opportunity</span></th>
                                                    <th scope="col"><span class="slds-truncate">Stage</span></th>
                                                    <th scope="col"><span class="slds-truncate">Business Unit</span></th>
                                                    <th scope="col"><span class="slds-truncate">Division</span></th>
                                                    <th scope="col"><span class="slds-truncate">Contract Term</span></th>
                                                    <th scope="col"><span class="slds-truncate">Contract Value</span></th>
                                                    <th scope="col"><span class="slds-truncate">Revenue Amount</span></th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <apex:repeat value="{!PriorityOpportunity}"  var="w">
                                                    <tr class="slds-hint-parent">
                                                        <td data-label="Account-name" role="row">
                                                            <b><span class="slds-truncate">{!HTMLENCODE(w.opp.Account.Name)}</span></b>
                                                        </td>
                                                        <td data-label="Account-name" role="row">
                                                            <b><span class="slds-truncate">{!HTMLENCODE(w.opp.Account.Owner.Name)}</span></b>
                                                        </td>
                                                        <td data-label="Opportunity-name">
                                                            <b><span class="slds-truncate" style="color:{!HTMLENCODE(w.licolor)}">{!HTMLENCODE(w.opp.Name)}</span></b>
                                                        </td>
                                                        <td data-label="Opportunity-name">
                                                            <span class="slds-truncate" >{!HTMLENCODE(w.opp.StageName)}</span>
                                                        </td>  
                                                        <td data-label="ContractTerm" style="text-align: right">
                                                            <span class="slds-truncate"><apex:outputText value="{!w.opp.BussinessUnit__c}" />  </span>
                                                        </td>
                                                        <td data-label="ContractTerm" style="text-align: right">
                                                            <span class="slds-truncate"><apex:outputText value="{!w.opp.Division__c}" />  </span>
                                                        </td>                                                       
                                                        <td data-label="ContractTerm" style="text-align: right">
                                                            <span class="slds-truncate"><apex:outputText value="{!w.opp.Deal_Duration__c}" />  </span>
                                                        </td>
                                                        <td data-label="Contractvalue" style="text-align: right">
                                                            <span class="slds-truncate">{!HTMLENCODE(userCurrencySign)} 
                                                            <apex:outputText value="{0, number, ###,###,###,###}">  
                                                                <apex:param value="{!w.opp.Deal_TCV__c}"/>  
                                                             </apex:outputText> 
                                                            </span>
                                                        </td>
                                                        <td data-label="Revenue Amount" style="text-align: right">
                                                            <span class="slds-truncate">{!HTMLENCODE(userCurrencySign)} 
                                                            <apex:outputText value="{0, number, ###,###,###,###}">  
                                                                <apex:param value="{!w.FiscalAmount}"/>  
                                                             </apex:outputText>
                                                            </span>
                                                        </td>

                                                    </tr>
                                                </apex:repeat>
                       
                                            </tbody>
                                        </table>
                                    
                                </div>
                               
        </apex:form>            
    </body>    
    </html>

</apex:page>